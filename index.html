<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ระบบสั่งอาหาร โรงเรียนตะพานหิน</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#f2f2f2;
}
.container{
  max-width:420px;
  width:92%;
  margin:40px auto;
  background:#fff;
  padding:16px;
  border-radius:12px;
  box-shadow:0 4px 16px rgba(0,0,0,.2);
}
h2,h3{text-align:center;margin:10px 0}
button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border:none;
  border-radius:8px;
  background:#2b7cff;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}
input,select{
  width:100%;
  padding:10px;
  margin:6px 0;
  border-radius:6px;
  border:1px solid #ccc;
}
.hidden{display:none}
</style>
</head>

<body>

<!-- หน้าแรก -->
<div class="container" id="home">
  <h2>สั่งอาหารโรงเรียนตะพานหิน</h2>
  <button onclick="showPage('login')">เข้าสู่ระบบ</button>
  <button onclick="showPage('register')">สมัครสมาชิก</button>
</div>

<!-- สมัครสมาชิก -->
<div class="container hidden" id="register">
  <h3>สมัครสมาชิก</h3>
  <select id="regRole">
    <option value="student">นักเรียน</option>
    <option value="seller">คนขาย</option>
  </select>
  <input id="regUser" placeholder="ชื่อผู้ใช้ (อย่างน้อย 10 ตัวอักษร)">
  <input id="regPass" type="password" placeholder="รหัสผ่าน (อย่างน้อย 10 ตัวอักษร)">
  <button onclick="register()">สมัคร</button>
  <button onclick="showPage('home')">กลับ</button>
</div>

<!-- เข้าสู่ระบบ -->
<div class="container hidden" id="login">
  <h3>เข้าสู่ระบบ</h3>
  <select id="loginRole">
    <option value="student">นักเรียน</option>
    <option value="seller">คนขาย</option>
  </select>
  <input id="loginUser" placeholder="ชื่อผู้ใช้">
  <input id="loginPass" type="password" placeholder="รหัสผ่าน">
  <button onclick="login()">เข้าสู่ระบบ</button>
  <button onclick="showPage('home')">กลับ</button>
</div>

<!-- หน้าร้าน -->
<div class="container hidden" id="shop">
  <h3 id="shopTitle">ร้านอาหาร</h3>
  <p style="text-align:center;color:#666">เข้าสู่ระบบสำเร็จ</p>
  <button onclick="logout()">ออกจากระบบ</button>
</div>

<script>
let currentRole = "";

/* เปลี่ยนหน้า */
function showPage(id){
  document.querySelectorAll('.container')
    .forEach(d => d.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

/* ตรวจสอบข้อมูล */
function validate(user, pass){
  if(!user || !pass){
    alert("❌ ต้องกรอกชื่อผู้ใช้และรหัสผ่าน");
    return false;
  }
  if(user.length < 10){
    alert("❌ ชื่อผู้ใช้ต้องมีอย่างน้อย 10 ตัวอักษร");
    return false;
  }
  if(pass.length < 10){
    alert("❌ รหัสผ่านต้องมีอย่างน้อย 10 ตัวอักษร");
    return false;
  }
  return true;
}

/* สมัครสมาชิก */
function register(){
  const user = regUser.value.trim();
  const pass = regPass.value.trim();
  const role = regRole.value;

  if(!validate(user, pass)) return;

  const account = { user, pass, role };
  localStorage.setItem("schoolAccount", JSON.stringify(account));

  alert("✅ สมัครสมาชิกสำเร็จ");
  showPage("login");
}

/* เข้าสู่ระบบ */
function login(){
  const user = loginUser.value.trim();
  const pass = loginPass.value.trim();
  const role = loginRole.value;

  if(!validate(user, pass)) return;

  const saved = JSON.parse(localStorage.getItem("schoolAccount"));

  if(!saved){
    alert("❌ ยังไม่มีบัญชีผู้ใช้");
    return;
  }

  if(user !== saved.user || pass !== saved.pass || role !== saved.role){
    alert("❌ ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง");
    showPage("home");
    return;
  }

  currentRole = role;
  document.getElementById("shopTitle").textContent =
    role === "seller" ? "หน้าคนขาย" : "หน้าร้านอาหาร";

  showPage("shop");
}

/* ออกจากระบบ */
function logout(){
  showPage("home");
}
</script>

</body>
</html>
